[根目录](../../../CLAUDE.md) > [lib](../../) > [plugins](../) > **timer**

---

# 计时器插件 (Timer Plugin) ⏱️

<PluginSwiper plugin-name="timer" />

⏱️ **Timer 计时器** - 精确掌控时间，提升工作效率

## 核心功能

### ⏰ 多种计时模式
- **正向计时**：从0开始计时，支持累计计时
- **倒计时**：设定目标时间倒计时结束
- **番茄钟**：25分钟工作+5分钟休息循环
- **秒表模式**：精确到毫秒的秒表功能
- **分段计时**：记录多个时间段

### 🎯 专注模式
- **专注工作**：创建专注任务，开启计时
- **休息提醒**：工作后自动提醒休息
- **连续计时**：可连续多个番茄钟
- **长休息**：每4个番茄钟后长休息15分钟
- **专注统计**：统计每日专注时长

### 📊 数据统计
- **时间统计**：统计每日/每周/每月计时
- **任务统计**：各任务耗时统计
- **效率分析**：分析工作效率变化
- **可视化图表**：直观的时间分配图表
- **趋势分析**：时间使用趋势分析

### 🔔 提醒系统
- **声音提醒**：计时结束时播放提醒音
- **振动提醒**：移动设备振动提醒
- **弹窗提醒**：屏幕弹窗提醒
- **通知栏提醒**：系统通知栏提醒
- **自定义铃声**：选择喜欢的提醒铃声

## 使用场景

### 工作学习
- **专注学习**：设定学习时间，提高专注力
- **工作计时**：记录各项工作耗时
- **考试计时**：考试时精确计时
- **会议计时**：控制会议时间

### 生活应用
- **运动计时**：记录跑步、健身时间
- **冥想计时**：辅助冥想和放松
- **烹饪计时**：厨房烹饪计时
- **午休计时**：控制午休时间

### 时间管理
- **番茄工作法**：提高工作效率
- **时间追踪**：了解时间花在哪里
- **效率优化**：识别高效时间段
- **任务计时**：为不同任务计时

## 操作指南

### 开始计时
1. 选择计时模式（正向/倒计时/番茄钟）
2. 设置计时时长（番茄钟默认为25分钟）
3. 点击「开始」按钮开始计时
4. 专注于当前任务
5. 计时结束查看统计

### 使用番茄钟
1. 选择番茄钟模式
2. 点击「开始工作」
3. 专注工作25分钟
4. 休息5分钟
5. 重复循环或结束

### 查看统计
1. 进入「统计」页面
2. 选择统计周期
3. 查看时间分配图表
4. 分析效率数据
5. 查看历史记录

## 高级功能

### 任务关联
- **关联任务**：与 Todo 插件关联计时
- **项目计时**：为整个项目计时
- **标签分类**：为计时添加标签
- **快速切换**：快速切换不同任务计时

### 自定义设置
- **时长自定义**：自定义番茄钟时长
- **休息时长**：设置休息时间长度
- **提醒设置**：自定义提醒方式
- **主题选择**：选择计时器主题

### 数据导出
- **报表导出**：导出时间统计报表
- **数据备份**：完整备份计时数据
- **分享功能**：分享时间统计
- **图表导出**：导出可视化图表

### 快捷操作
- **快捷键**：支持键盘快捷键
- **小组件**：桌面小组件快速计时
- **语音控制**：语音开始/暂停计时
- **后台计时**：支持后台继续计时

## 技术架构

### 数据模型

**TimerTask (计时任务)**
- 任务ID、名称、颜色、图标
- 多个计时器列表（顺序执行）
- 重复次数和分组管理
- 运行状态持久化

**TimerItem (计时器项)**
- 三种类型：正计时、倒计时、番茄钟
- 精确到毫秒的计时精度
- 间隔提示功能
- 阶段自动切换（番茄钟）

### 核心 API

```dart
// 任务管理
List<TimerTask> getTasks();
Future<void> addTask(TimerTask task);
Future<void> removeTask(String taskId);
Future<void> updateTask(TimerTask task);

// 前台通知服务
Future<void> startNotificationService(TimerTask task);
Future<void> stopNotificationService([String? taskId]);
Future<void> _updateNotification(TimerTask task);

// 统计接口
int getTotalTimerCount() => _tasks.length;
```

### 事件系统

| 事件名 | 触发时机 | 说明 |
|-------|---------|------|
| `timer_task_changed` | 任务状态变化时 | 包含 TimerTask 对象 |
| `timer_item_changed` | 计时器状态变化时 | 包含 TimerItem 对象 |
| `timer_item_progress` | 计时器进度更新时(每秒) | 包含 TimerItem 对象 |

### 存储结构

```
timer/
└── tasks.json              # 所有任务数据
```

## 时间管理技巧

⏰ **番茄工作法**：25分钟专注+5分钟休息的工作节奏

⏰ **时间块**：将一天分为多个时间块

⏰ **时间记录**：记录时间使用情况

⏰ **优先级排序**：为任务分配合理时间

## 小贴士

💡 **保持专注**：计时期间保持专注，避免分心

💡 **规律休息**：合理安排休息时间

💡 **数据回顾**：定期回顾时间使用数据

💡 **调整策略**：根据数据调整时间分配

## 常见问题

**Q: 计时会受锁屏影响吗？**
A: 不会，计时在后台继续进行。

**Q: 可以同时运行多个计时器吗？**
A: 支持同时运行多个计时任务。

**Q: 计时数据会丢失吗？**
A: 数据自动保存，支持云端同步。

**Q: 如何暂停计时？**
A: 点击暂停按钮，计时会停止并保留当前时间。

---

*让每一分钟都更有价值*
